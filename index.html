<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>LifeGo AR Teleport</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
  
  <script>
    // 터치할 때마다 현실 <-> 가상 세계를 전환하는 로직
    AFRAME.registerComponent('dimension-switcher', {
      init: function () {
        this.isVirtual = false;
        this.dome = document.querySelector("#world-dome");
        this.text = document.querySelector("#guide-text");
        
        // 화면 전체 터치 이벤트
        this.el.sceneEl.addEventListener('click', () => {
            this.toggleDimension();
        });
      },

      toggleDimension: function () {
        this.isVirtual = !this.isVirtual;
        
        if (this.isVirtual) {
            // 가상 모드: 돔을 불투명하게 만들고 서서히 등장시킴
            this.dome.setAttribute('visible', 'true');
            this.dome.setAttribute('animation', 'property: material.opacity; from: 0; to: 1; dur: 1000; easing: easeOutQuad');
            this.text.setAttribute('value', 'Return to Reality');
        } else {
            // 현실 모드: 돔을 투명하게 만들고 숨김
            this.dome.setAttribute('animation', 'property: material.opacity; from: 1; to: 0; dur: 800; easing: easeInQuad');
            // 애니메이션 끝나면 visible false 처리는 생략 (자연스러운 전환 위해)
            this.text.setAttribute('value', 'Tab to Enter Van Gogh World');
        }
      }
    });
  </script>
</head>

<body>
  <a-scene 
    webxr="requiredFeatures: hit-test; optionalFeatures: dom-overlay; overlayElement: #overlay"
    renderer="alpha: true; antialias: true; colorManagement: true;">

    <a-assets>
      <img id="gogh-img" src="https://cdn.aframe.io/360-image-gallery-boilerplate/img/sechelt.jpg" crossorigin="anonymous">
      </a-assets>

    <a-sky id="world-dome" 
           src="#gogh-img" 
           radius="50" 
           opacity="0"
           visible="true">
    </a-sky>

    <a-text id="guide-text"
            value="Tap to Enter World" 
            position="0 0 -2" 
            align="center" 
            color="white" 
            scale="0.5 0.5 0.5"
            shader="msdf"
            font="https://raw.githubusercontent.com/etiennepinchon/aframe-fonts/master/fonts/roboto/Roboto-Bold.json">
    </a-text>

    <a-light type="ambient" intensity="1"></a-light>

    <a-entity dimension-switcher></a-entity>
    
    <div id="overlay"></div>

  </a-scene>
</body>
</html>
